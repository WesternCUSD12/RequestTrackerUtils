{% extends 'base.html' %}

{% block title %}Student Device Check-in List{% endblock %}

{% block content %}
<div class="container py-4">
  <!-- Breadcrumb Navigation -->
  <nav aria-label="breadcrumb" class="mb-4">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="/">Home</a></li>
      <li class="breadcrumb-item"><a href="/devices">Devices</a></li>
      <li class="breadcrumb-item active" aria-current="page">Student Device List</li>
    </ol>
  </nav>

  <div class="row mb-4">
    <div class="col-12">
      <h1 class="mb-3">Student Device Tracking</h1>
      <p class="lead">Track device check-ins by grade for the {{ current_year }} school year.</p>
    </div>
  </div>

  <!-- Dashboard Cards -->
  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card bg-primary text-white h-100">
        <div class="card-body">
          <h5 class="card-title">Total Students</h5>
          <h2 class="display-4" id="stat-total-students">{{ stats.total_students }}</h2>
          <p class="card-text small" id="stat-total-label">All students</p>
        </div>
      </div>
    </div>
    
    <div class="col-md-3">
      <div class="card bg-success text-white h-100">
        <div class="card-body">
          <h5 class="card-title">Checked In</h5>
          <h2 class="display-4" id="stat-checked-in">{{ stats.checked_in }}</h2>
          <p class="card-text small" id="stat-checked-label">All students</p>
        </div>
      </div>
    </div>
    
    <div class="col-md-3">
      <div class="card bg-warning text-dark h-100">
        <div class="card-body">
          <h5 class="card-title">Pending</h5>
          <h2 class="display-4" id="stat-not-checked-in">{{ stats.not_checked_in }}</h2>
          <p class="card-text small" id="stat-pending-label">All students</p>
        </div>
      </div>
    </div>
    
    <div class="col-md-3">
      <div class="card bg-info text-white h-100">
        <div class="card-body">
          <h5 class="card-title">Completion Rate</h5>
          <h2 class="display-4" id="stat-completion-rate">{{ "%.1f"|format(stats.completion_rate) }}%</h2>
          <p class="card-text small" id="stat-rate-label">All students</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card">
        <div class="card-body d-flex justify-content-between">
          <div>
            <button id="refreshStudentsBtn" class="btn btn-outline-primary me-2">
              <i class="bi bi-arrow-clockwise"></i> Refresh
            </button>
            <button id="checkRtAssignmentsBtn" class="btn btn-outline-info me-2">
              <i class="bi bi-check-circle"></i> Check RT Assignments
            </button>
            <a href="{% url 'students:import' %}" class="btn btn-outline-success me-2">
              <i class="bi bi-file-earmark-arrow-up"></i> Import Students
            </a>
            <a href="{% url 'students:student-export' %}" class="btn btn-outline-secondary me-2">
              <i class="bi bi-file-earmark-arrow-down"></i> Export CSV
            </a>
            <button id="clearAllStudentsBtn" class="btn btn-outline-danger me-2">
              <i class="bi bi-trash"></i> Clear All Students
            </button>
          </div>
          <div>
            <button id="addStudentBtn" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addStudentModal">
              <i class="bi bi-person-plus"></i> Add Student
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- The rest of the template content goes here... -->
  <!-- This is a minimal conversion focusing on url_for to {% url %} changes -->
  <p class="text-muted">Student device tracking interface (full template content needed)</p>
</div>
{% endblock %}

{% block scripts %}
<script>
// JavaScript will be added here for student device management
// This requires additional routes and API endpoints to be implemented
console.log('Student devices page loaded');
</script>
{% endblock %}
